
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Python Unittest: Handle the Command Line Arguments That Your Program Need - euccas.github.io</title>
  <meta name="author" content="euccas">

  
  <meta name="description" content="In the previous post about Python Unittest, I wrote about the basic steps needed for setting up unit testing for your Python program with the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://euccas.github.io/blog/20160807/python-unittest-handle-command-line-arguments.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="euccas.github.io" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">euccas.github.io</a></h1>
  
    <h2>why a developer writes</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="euccas.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Python Unittest: Handle the Command Line Arguments That Your Program Need</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-08-07T11:57:32-07:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>11:57 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>In the previous post about <a href="http://euccas.github.io/blog/20160711/start-unit-testing-in-python.html">Python Unittest</a>, I wrote about the basic steps needed for setting up unit testing for your Python program with the <code>unittest</code> module. In this post, I’ll discuss about handling the command line parameters that your program need while you’re using Python <code>unittest</code>.</p>

<p>Unit testing is meant for testing basic functionality of the application. The target of <a href="https://en.wikipedia.org/wiki/Unit_testing">Unit testing</a> is expected to be each function of your program. When your program has command line arguments, ideally the unit tests should not accept arguments from the command line because unit tests are supposed to be very specific and not testing on the <a href="https://en.wikipedia.org/wiki/Integration_testing">Integration level</a> (i.e. across multiple functions in your program).</p>

<p>So the way I use to handle the command line arguments can be summarized as:
- Refactor your program to have the arguments parsing as a function
- Refactor your program to handle the arguments parsing differently when doing unit testing
- In the unit tests, set the arguments and pass them directly to the functions under test</p>

<p>The following is a demo Python project I built to demonstrate handling command line arguments when using <code>unittest</code>.</p>

<h2 id="myapppy">myapp.py</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
</pre></td><td class="code"><pre><code class=""><span class="line">#!/usr/bin/env python
</span><span class="line">
</span><span class="line">import sys, os.path, re
</span><span class="line">import argparse
</span><span class="line">
</span><span class="line">class myApp():
</span><span class="line">
</span><span class="line">    EXIT_PASS, EXIT_FAIL = 0, 1
</span><span class="line">
</span><span class="line">    def __init__(self, mode = 'normal', test_param = None):
</span><span class="line">        # Validate and process argument options
</span><span class="line">        self.parse_args(mode, test_param)
</span><span class="line">
</span><span class="line">        # Initialize database connection
</span><span class="line">        self.app_name = self.get_app_name(self.name)
</span><span class="line">
</span><span class="line">    def parse_args(self, mode, test_param):
</span><span class="line">        if mode == 'unittest':
</span><span class="line">            if test_param is None:
</span><span class="line">                print("Missing test param")
</span><span class="line">                self.app_exit('fail')
</span><span class="line">
</span><span class="line">            self.name = test_param['app_name']
</span><span class="line">            self.verbose = test_param['verbose']
</span><span class="line">        else:
</span><span class="line">            parser = argparse.ArgumentParser(description='myApp: A demo project')
</span><span class="line">            parser.add_argument('-n', '--name', help='Name of myApp', required=True)
</span><span class="line">            parser.add_argument('--verbose', action='store_true', help='Verbose mode with more information printed')
</span><span class="line">
</span><span class="line">            args = parser.parse_args()
</span><span class="line">
</span><span class="line">            self.name = args.name
</span><span class="line">            self.verbose = args.verbose
</span><span class="line">
</span><span class="line">    def app_exit(self, status):
</span><span class="line">        if status.lower() == 'pass':
</span><span class="line">            print("** App Exit Status: PASS \n")
</span><span class="line">            exit(self.EXIT_PASS)
</span><span class="line">        elif status.lower() == 'skip':
</span><span class="line">            print("** App Exit Status: SKIP \n")
</span><span class="line">            exit(self.EXIT_PASS)
</span><span class="line">        else:
</span><span class="line">            print("** App Exit Status: FAIL \n")
</span><span class="line">            exit(self.EXIT_FAIL)
</span><span class="line">
</span><span class="line">    def get_app_name(self):
</span><span class="line">        app_name = self.name
</span><span class="line">
</span><span class="line">        return app_name
</span><span class="line">
</span><span class="line">
</span><span class="line">if __name__ == '__main__':
</span><span class="line">    app = myApp()
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="testmyapppy">test_myapp.py</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
</pre></td><td class="code"><pre><code class=""><span class="line">#!/usr/bin/env python
</span><span class="line">
</span><span class="line">import sys, os.path, re
</span><span class="line">import argparse
</span><span class="line">import unittest
</span><span class="line">
</span><span class="line">bin_path = os.path.dirname(os.path.realpath(__file__))
</span><span class="line">lib_path = os.path.abspath(bin_path)
</span><span class="line">sys.path.insert(0, lib_path)
</span><span class="line">
</span><span class="line">import myApp
</span><span class="line">
</span><span class="line">class myAppTestCase(unittest.TestCase):
</span><span class="line">
</span><span class="line">    def setUp(self):
</span><span class="line">        mode = 'unittest'
</span><span class="line">        test_param = {
</span><span class="line">            'name': 'Test App',
</span><span class="line">            'verbose': True
</span><span class="line">        }
</span><span class="line">        self.app = myapp.myApp(mode, test_param)
</span><span class="line">
</span><span class="line">    def test_app_name(self):
</span><span class="line">        self.assertEqual(self.app.get_app_name, 'Test App', 'Wrong App Name')
</span><span class="line">
</span><span class="line">    def tearDown(self):
</span><span class="line">        print('Bye Test')
</span><span class="line">
</span><span class="line">if __name__ == '__main__':
</span><span class="line">    unittest.main()</span></code></pre></td></tr></table></div></figure></notextile></div>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">euccas</span></span>

      




<time class='entry-date' datetime='2016-08-07T11:57:32-07:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>11:57 am</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://euccas.github.io/blog/20160807/python-unittest-handle-command-line-arguments.html" data-via="" data-counturl="http://euccas.github.io/blog/20160807/python-unittest-handle-command-line-arguments.html" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/20160711/start-unit-testing-in-python.html" title="Previous Post: Start Unit Testing in Python">&laquo; Start Unit Testing in Python</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/20160807/python-unittest-handle-command-line-arguments.html">Python Unittest: Handle the Command Line Arguments That Your Program Need</a>
      </li>
    
      <li class="post">
        <a href="/blog/20160711/start-unit-testing-in-python.html">Start Unit Testing in Python</a>
      </li>
    
      <li class="post">
        <a href="/blog/20160614/rake-automake-your-tasks-in-ruby.html">Rake: Automake Your Tasks in Ruby</a>
      </li>
    
      <li class="post">
        <a href="/blog/20160610/rails-get-data-without-model.html">Rails: Get Data From PostgreSQL Database Without the Model</a>
      </li>
    
      <li class="post">
        <a href="/blog/20160607/ruby-class-and-instance-methods.html">Ruby Class and Instance Methods</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - euccas -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
